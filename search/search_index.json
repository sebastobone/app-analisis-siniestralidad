{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Introducci\u00f3n","text":""},{"location":"#descripcion","title":"Descripci\u00f3n","text":"<p>Aplicaci\u00f3n que permite realizar c\u00e1lculos de siniestralidad \u00faltima por medio de la metodolog\u00eda Chain-Ladder. Adicionalmente, permite realizar seguimiento y rec\u00e1lculos de la siniestralidad entre cada an\u00e1lisis de tri\u00e1ngulos por medio de metodolog\u00edas de entrem\u00e9s.</p>"},{"location":"configuracion/","title":"Configuraci\u00f3n","text":""},{"location":"configuracion/#consultas-o-queries","title":"Consultas o queries","text":"<p>Para realizar un an\u00e1lisis de tri\u00e1ngulos o entrem\u00e9s y calcular una siniestralidad \u00faltima, necesitamos contar con informaci\u00f3n de siniestros, primas, y expuestos. La principal forma de obtener esta informaci\u00f3n es a trav\u00e9s de consultas de Teradata, las cuales ser\u00e1n almacenadas en la carpeta <code>data/queries</code>.</p> <p>Los queries contenidos por defecto en esta carpeta son los que utiliza actualmente cada negocio para su proceso mensual de cierre de reservas. Si desea realizar un an\u00e1lisis diferente, modifique estos queries de tal forma que la salida que generen contenga, como m\u00ednimo, las siguientes columnas:</p>"},{"location":"configuracion/#siniestros","title":"Siniestros","text":"<ul> <li>codigo_op</li> <li>codigo_ramo_op</li> <li>\"columnas de aperturas\" (por ejemplo: canal, amparo, tipo de veh\u00edculo, etc.)</li> <li>fecha_siniestro</li> <li>fecha_registro</li> <li>conteo_pago</li> <li>conteo_incurrido</li> <li>conteo_desistido</li> <li>pago_bruto</li> <li>pago_retenido</li> <li>aviso_bruto</li> <li>aviso_retenido</li> </ul>"},{"location":"configuracion/#primas","title":"Primas","text":"<ul> <li>codigo_op</li> <li>codigo_ramo_op</li> <li>\"columnas de aperturas\" (pueden diferir de las columnas de aperturas de siniestros y expuestos)</li> <li>fecha_registro</li> <li>prima_bruta</li> <li>prima_bruta_devengada</li> <li>prima_retenida</li> <li>prima_retenida_devengada</li> </ul>"},{"location":"configuracion/#expuestos","title":"Expuestos","text":"<ul> <li>codigo_op</li> <li>codigo_ramo_op</li> <li>\"columnas de aperturas\" (pueden diferir de las columnas de aperturas de siniestros y expuestos)</li> <li>fecha_registro</li> <li>expuestos</li> <li>vigentes</li> </ul>"},{"location":"configuracion/#definicion-de-aperturas","title":"Definici\u00f3n de aperturas","text":"<p>Para definir las aperturas sobre las cuales se calcular\u00e1 la siniestralidad \u00faltima, se tienen dos alternativas:</p> <ol> <li>Definir la apertura directamente desde el query. Este camino se recomienda si la apertura es sencilla y no depende de otras aperturas. Por ejemplo:</li> </ol> <pre><code>CASE\n    WHEN fas.clase_tarifa_cd IN (2, 3) THEN 'MOTOS'\n    WHEN fas.clase_tarifa_cd IN (4, 5, 6) THEN 'UTILITARIOS'\n    ELSE 'LIVIANOS'\nEND AS tipo_vehiculo_desc\n</code></pre> <ol> <li> <p>Definir la apertura desde el archivo <code>data/segmentacion.xlsx</code>. Este camino se recomienda si la apertura tiene una l\u00f3gica compleja o depende de otras aperturas. Para ello, se deben seguir los siguientes pasos:</p> </li> <li> <p>Crear una nueva hoja en el Excel. El nombre de la hoja debe seguir el siguiente formato: <code>add_{indicador_cantidad}_{alias_apertura}</code>.</p> <p><code>indicador_cantidad</code> admite tres posibles valores: <code>s</code> para siniestros, <code>p</code> para primas, y <code>e</code> para expuestos. Por ejemplo, si los siniestros se van a aperturar por amparo, el nombre de la hoja ser\u00eda <code>add_s_Amparos</code>. Si tanto siniestros como primas y expuestos se van a aperturar por esta variable, el nombre ser\u00eda <code>add_spe_Amparos</code>.</p> </li> <li> <p>Crear la tabla con la definicion de la apertura. A continuacion, se muestra un ejemplo:</p> <p></p> <p>Las columnas grises de la imagen corresponden a las columnas como aparecen en Teradata, mientras que la columna azul oscura representa la definici\u00f3n de la apertura creada por el usuario.</p> </li> <li> <p>Al principio del query, crear una tabla vol\u00e1til para recibir la tabla creada anteriormente. Siguiendo el mismo ejemplo:</p> <pre><code>CREATE MULTISET VOLATILE TABLE canal_poliza\n(\n    compania_id SMALLINT NOT NULL\n    , codigo_op VARCHAR(100) NOT NULL\n    , ramo_id INTEGER NOT NULL\n    , codigo_ramo_op VARCHAR(100) NOT NULL\n    , poliza_id BIGINT NOT NULL\n    , numero_poliza VARCHAR(100) NOT NULL\n    , apertura_canal_desc VARCHAR(100) NOT NULL\n) PRIMARY INDEX (\n    poliza_id, codigo_ramo_op, compania_id\n) ON COMMIT PRESERVE ROWS;\nINSERT INTO CANAL_POLIZA VALUES (?, ?, ?, ?, ?, ?, ?);\nCOLLECT STATISTICS ON canal_poliza INDEX (poliza_id, codigo_ramo_op, compania_id);\n</code></pre> <p>Es importante, cuando cree este tipo de tablas, recolectar estad\u00edsticas (<code>COLLECT STATISTICS...</code>), de forma que la tabla pueda ser estudiada por el motor interno de Teradata y el query pueda ser optimizado.</p> </li> <li> <p>Utilizar la tabla en las consultas para definir la apertura.</p> <pre><code>SELECT\n    ...\n    , COALESCE(p.apertura_canal_desc, 'RESTO') AS apertura_canal_desc\n    ...\n\nFROM mdb_seguros_colombia.v_hist_polcert_cobertura AS vpc\n...\nLEFT JOIN\n    canal_poliza AS p\n    ON\n        vpc.poliza_id = p.poliza_id\n        AND ramo.codigo_ramo_op = p.codigo_ramo_op\n        AND cia.compania_id = p.compania_id\n\nWHERE ...\nGROUP BY ...\n</code></pre> </li> </ol>"},{"location":"instalacion/","title":"Instalaci\u00f3n","text":""},{"location":"instalacion/#prerrequisitos","title":"Prerrequisitos","text":"<p>Para instalar la plantilla y empezarla a usar en un nuevo an\u00e1lisis, debe tener instalado previamente en su equipo Git y uv.</p>"},{"location":"instalacion/#instrucciones","title":"Instrucciones","text":"<ol> <li>Entre a la carpeta donde va a almacenar el an\u00e1lisis.</li> <li>Abra una terminal en esta carpeta. Para ello, seleccione la carpeta, presione click derecho, y seleccione abrir nueva terminal.</li> <li>En la terminal, copie lo siguiente y presione enter:</li> </ol> <pre><code>git clone https://github.com/sebastobone/app-analisis-siniestralidad.git\ncd app-analisis-siniestralidad\nuv sync --no-dev\n</code></pre> <p>Para hacer la extraccion de queries, se crear\u00e1 un archivo para almacenar sus credenciales de Teradata. Pegue lo siguiente en la terminal:</p> WindowsMacOS <pre><code>Set-Content -Path \".\\.env.private\" -Value 'TERADATA_USER=\"___\"' -NoNewLine\nAdd-Content -Path \".\\.env.private\" -Value \"`nTERADATA_PASSWORD=\"\"___\"\"\"\n</code></pre> <pre><code>echo 'TERADATA_USER=\"___\"' &gt; .env.private\necho 'TERADATA_PASSWORD=\"___\"' &gt;&gt; .env.private\n</code></pre> <p>Este archivo queda almacenado dentro de la carpeta principal. Si necesita editarlo, puede abrirlo en el bloc de notas.</p> <p>\u00a1Eso es todo! Ahora puede proceder con la configuraci\u00f3n del an\u00e1lisis. No cierre la terminal, la usar\u00e1 para ejecutar el proceso despu\u00e9s.</p>"},{"location":"uso/","title":"Uso de la plantilla","text":"<p>Para iniciar la plantilla, escriba la siguiente l\u00ednea en la terminal y presione enter:</p> <pre><code>uv run run.py\n</code></pre> <p>El comando anterior iniciar\u00e1 la plantilla en el localhost. Utilice el navegador para dirigirse a esa ruta.</p>"}]}